<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login Page</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="login-container">
        <h2>Login</h2>
        <a id="login-button" href="#">Login with Google</a>
        <div id="error-message"></div>
    </div>

    <div id="content" style="display:none;">
        <h2>Welcome!</h2>
        <iframe src="https://drive.google.com" width="600" height="400"></iframe>
        <iframe src="YOUR_PDF_URL" width="600" height="400"></iframe>
        <div id="gqueue-tasks"></div>
        <button id="logout-button">Logout</button>
    </div>

    <script>
        const CLIENT_ID = '368441345753-oljn46dcj2cfc123ahd4sk4va3skbjd2.apps.googleusercontent.com'; // Replace with your Google Client ID
        const REDIRECT_URI = 'https://vanguardadvisory.github.io/memberstack-script/'; // Replace with your GitHub Pages URL
        const SCOPES = 'email profile';
        const WHITELISTED_EMAIL = 'user123@gmail.com';

        document.getElementById("login-button").onclick = function() {
            const authUrl = `https://accounts.google.com/o/oauth2/v2/auth?client_id=${CLIENT_ID}&redirect_uri=${REDIRECT_URI}&response_type=token&scope=${SCOPES}`;
            window.location.href = authUrl;
        };

        // Check for access token in URL
        const urlParams = new URLSearchParams(window.location.hash.substr(1));
        const accessToken = urlParams.get('access_token');

        if (accessToken) {
            fetch('https://www.googleapis.com/oauth2/v1/userinfo?access_token=' + accessToken)
                .then(response => response.json())
                .then(user => {
                    if (user.email === WHITELISTED_EMAIL) {
                        document.getElementById("login-container").style.display = "none";
                        document.getElementById("content").style.display = "block";
                        loadGQueueTasks(); // Call function to load GQueue tasks
                    } else {
                        document.getElementById("error-message").innerText = "Unauthorized access!";
                    }
                })
                .catch(error => {
                    document.getElementById("error-message").innerText = error.message;
                });
        }

        document.getElementById("logout-button").onclick = function() {
            window.location.href = REDIRECT_URI; // Redirect to logout
        };

        function loadGQueueTasks() {
            // Fetch tasks from GQueue and display them here
            // This is a placeholder function; implement your logic to get tasks.
            document.getElementById("gqueue-tasks").innerText = "Tasks from GQueue will appear here.";
        }
    </script>
</body>
</html>
